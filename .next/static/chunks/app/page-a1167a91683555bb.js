(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2698:(e,t,s)=>{Promise.resolve().then(s.bind(s,6774))},6774:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var i=s(7437),a=s(2265),r=s(1180),n=s(2035),o=s(5361),d=s(7138);function l(e){let{focusMin:t=25,breakMin:s=5,onCycle:r}=e,[n,o]=(0,a.useState)("focus"),[d,l]=(0,a.useState)(60*t),[c,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!c)return;let e=setInterval(()=>l(e=>e>0?e-1:0),1e3);return()=>clearInterval(e)},[c]),(0,a.useEffect)(()=>{if(0===d){let e="focus"===n?"break":"focus";o(e),l("focus"===e?60*t:60*s),null==r||r(e)}},[d,n,t,s,r]);let p=String(Math.floor(d/60)).padStart(2,"0"),f=String(d%60).padStart(2,"0");return(0,i.jsxs)("div",{style:{border:"1px solid #222",padding:16,borderRadius:12,background:"#111"},children:[(0,i.jsx)("h3",{style:{marginTop:0},children:n.toUpperCase()}),(0,i.jsxs)("div",{style:{fontSize:48,fontWeight:700,letterSpacing:1,margin:"12px 0"},children:[p,":",f]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("button",{onClick:()=>u(e=>!e),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #333",background:"#1a1a1a",color:"#fff"},children:c?"Pause":"Start"}),(0,i.jsx)("button",{onClick:()=>l(e=>e+60),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #333",background:"#1a1a1a",color:"#fff"},children:"+1 min"}),(0,i.jsx)("button",{onClick:()=>l(0),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #333",background:"#1a1a1a",color:"#fff"},children:"Skip"}),(0,i.jsx)("button",{onClick:()=>{o("focus"),l(60*t),u(!1)},style:{padding:"8px 12px",borderRadius:8,border:"1px solid #333",background:"#1a1a1a",color:"#fff"},children:"Reset"})]})]})}function c(){let e=(0,r.e)(),[t,s]=(0,a.useState)(null),[c,u]=(0,a.useState)([]),[p,f]=(0,a.useState)(""),[b,x]=(0,a.useState)("");async function g(){if(!p)return alert("Pick a habit");let{data:s,error:i}=await e.from("sessions").insert({habit_id:p,user_id:t.user.id,planned_duration_min:25,notes:"Started from web"}).select("id").single();i?alert(i.message):console.log("Session started",s.id)}async function h(){let{data:s}=await e.from("sessions").select("id").eq("user_id",t.user.id).eq("habit_id",p).order("started_at",{ascending:!1}).limit(1).maybeSingle();if(!s)return alert("No session to complete.");let{error:i}=await e.from("sessions").update({completed:!0,actual_duration_min:25,notes:b||null}).eq("id",s.id);i?alert(i.message):(x(""),alert("Session completed \uD83C\uDF89"))}return((0,a.useEffect)(()=>{e.auth.getSession().then(e=>{let{data:t}=e;return s(t.session)});let{data:t}=e.auth.onAuthStateChange((e,t)=>s(t));return()=>{t.subscription.unsubscribe()}},[]),(0,a.useEffect)(()=>{t&&(async()=>{let{data:t,error:s}=await e.from("habits").select("id, title, target_per_week").order("created_at",{ascending:!0});!s&&t&&u(t)})()},[t]),t)?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("h1",{children:"Welcome"}),(0,i.jsx)("button",{onClick:()=>e.auth.signOut(),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #333",background:"#1a1a1a",color:"#fff"},children:"Sign out"})]}),(0,i.jsx)("h2",{style:{marginTop:0},children:"Pick a Habit"}),(0,i.jsxs)("select",{value:p,onChange:e=>f(e.target.value),style:{padding:8,borderRadius:8,background:"#111",color:"#fff",border:"1px solid #333"},children:[(0,i.jsx)("option",{value:"",children:"-- select --"}),c.map(e=>(0,i.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,i.jsxs)("div",{style:{marginTop:16,display:"grid",gap:16},children:[(0,i.jsx)(l,{onCycle:e=>console.log("Cycle ->",e)}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("button",{onClick:g,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2a2a2a",background:"#151515",color:"#fff"},children:"Start Session"}),(0,i.jsx)("button",{onClick:h,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2a2a2a",background:"#151515",color:"#fff"},children:"Complete Session"})]}),(0,i.jsx)("textarea",{placeholder:"Optional note...",value:b,onChange:e=>x(e.target.value),rows:3,style:{width:"100%",padding:10,borderRadius:8,background:"#101010",color:"#fff",border:"1px solid #333"}}),(0,i.jsx)("p",{style:{opacity:.8},children:"New account? Run the seed function to create 5 sample habits (see README)."}),(0,i.jsx)("p",{children:(0,i.jsx)(d.default,{href:"/stats",children:"View Stats"})})]})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Atomic Habits + Pomodoro"}),(0,i.jsx)("p",{children:"Sign in to start building tiny wins."}),(0,i.jsx)(n.gx,{supabaseClient:e,appearance:{theme:o.rD},providers:[],view:"sign_in"}),(0,i.jsx)("p",{style:{opacity:.8,marginTop:8},children:"Tip: Enable email OTP or magic link in Supabase Auth."})]})}},1180:(e,t,s)=>{"use strict";s.d(t,{e:()=>a});var i=s(9851);function a(){return(0,i.createBrowserClient)("https://skawbgonxuepxzovkrlg.supabase.co","your_supabase_anon_keyeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNrYXdiZ29ueHVlcHh6b3ZrcmxnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxNTUyNjYsImV4cCI6MjA3MzczMTI2Nn0.VqVR5-f2AniB_igWvNLKepBrJkvHXd1IsgoD1zTRLpU")}}},e=>{var t=t=>e(e.s=t);e.O(0,[851,655,130,215,744],()=>t(2698)),_N_E=e.O()}]);